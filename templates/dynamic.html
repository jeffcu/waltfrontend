<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Graph</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1E2A38;
            color: #E5E5E5;
            padding: 20px;
            text-align: center;
        }
        canvas {
            background-color: #fff;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <h1>Dynamic Graph</h1>
    <canvas id="myCanvas" width="256" height="256"></canvas>
    <script>
        window.onload = function() {
            const canvas = document.getElementById("myCanvas");
            const ctx = canvas.getContext("2d");

            fetch('/dynamic_data')
                .then(response => response.json())
                .then(data => {
                    //Option 1: Sine Wave
                    //drawSineWave(ctx, data.x, data.y, canvas.width, canvas.height);
                    //Option 2: Mandelbrot Set
                    drawMandelbrot(ctx, data, canvas.width, canvas.height);
                });
        };

        function drawMandelbrot(ctx, data, width, height) {
            for (let i = 0; i < height; i++) {
                for (let j = 0; j < width; j++) {
                    let val = data[i][j];
                    let color = `rgb(${val}, ${val}, ${val})`; //Gray Scale
                    ctx.fillStyle = color;
                    ctx.fillRect(j, i, 1, 1);
                }
            }
        }
        function drawSineWave(ctx, x_values, y_values, width, height) {
             ctx.beginPath();
             ctx.strokeStyle = 'blue';

             // Scale the sine wave to fit the canvas
             const xScale = width / (x_values[x_values.length - 1] - x_values[0]);
             const yScale = height / 2; // Center the sine wave vertically
             const yOffset = height / 2; // Vertical offset to center the sine wave

            for (let i = 0; i < x_values.length; i++) {
                const x = (x_values[i] - x_values[0]) * xScale; // Scale x to canvas width
                const y = yOffset - y_values[i] * yScale * .95; // Scale y to canvas height
                if (i === 0) {
                    ctx.moveTo(x, y);
                 } else {
                    ctx.lineTo(x, y);
                 }
            }
            ctx.stroke();
        }

    </script>
</body>
</html>
